–¢–µ—Å—Ç–æ–≤–æ–µ –∫–∞—Å–ø–µ—Ä—Å–∫–∏

–ü—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ —Å Prometheus –º–µ—Ç—Ä–∏–∫–∞–º–∏ –Ω–∞ Yandex Cloud —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Terraform –∏ Ansible. (–≤—Å–µ –±–æ–Ω—É—Å–Ω—ã–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã)

–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

Yandex Cloud –∞–∫–∫–∞—É–Ω—Ç
Terraform >= 1.0
Ansible >= 2.9

# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repository-url>
cd microservice-deployment

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
sudo sh deploy.sh container # –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ —Ä–µ–∂–∏–º–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞(–¥–æ–∫–µ—Ä)
sudo sh deploy.sh virtual # –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ —Ä–µ–∂–∏–º–µ —Å–µ—Ä–≤–∏—Å–∞ systemd


üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

text
‚îú‚îÄ‚îÄ terraform/          # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–∫ –∫–æ–¥
‚îú‚îÄ‚îÄ python-metrics-app/ # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ ansible/            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ ssh/                # SSH –∫–ª—é—á–∏ (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–æ –Ω—É–∂–µ–Ω root)
‚îî‚îÄ‚îÄ deploy.sh           # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
üîß –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å



Prometheus –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –ø–æ—Ä—Ç—É 8080
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Ö–æ—Å—Ç–∞ (VM/Container/Physical)



üóÇÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã

microservice/app.py - Python –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å
terraform/main.tf - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
ansible/site.yml - –ü–ª–µ–π–±—É–∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
deploy.sh - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π

üìä –ú–µ—Ç—Ä–∏–∫–∏

http_requests_total - —Å—á–µ—Ç—á–∏–∫ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
host_type - —Ç–∏–ø —Ö–æ—Å—Ç–∞ (0=VM, 1=Container, 2=Physical)